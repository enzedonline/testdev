!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Quill")):"function"==typeof define&&define.amd?define(["Quill"],e):"object"==typeof exports?exports.QuillBlotFormatter2=e(require("Quill")):t.QuillBlotFormatter2=e(t.Quill)}(self,(t=>(()=>{"use strict";var e={796:(t,e,r)=>{r.r(e),r.d(e,{default:()=>a});var o=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===n}(t)}(t)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((r=t,Array.isArray(r)?[]:{}),t,e):t;var r}function s(t,e,r){return t.concat(e).map((function(t){return i(t,r)}))}function l(t,e,r){(r=r||{}).arrayMerge=r.arrayMerge||s,r.isMergeableObject=r.isMergeableObject||o;var n=Array.isArray(e);return n===Array.isArray(t)?n?r.arrayMerge(t,e,r):function(t,e,r){var o={};return r.isMergeableObject(t)&&Object.keys(t).forEach((function(e){o[e]=i(t[e],r)})),Object.keys(e).forEach((function(n){r.isMergeableObject(e[n])&&t[n]?o[n]=l(t[n],e[n],r):o[n]=i(e[n],r)})),o}(t,e,r):i(e,r)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,r){return l(t,r,e)}),{})};const a=l},797:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(796)),i=o(r(402)),s=(t,e)=>e;e.default=class{constructor(t,e={}){this.onClick=()=>{this.hide()},this.quill=t,this.options=(0,n.default)(i.default,e,{arrayMerge:s}),this.currentSpec=null,this.actions=[],this.overlay=document.createElement("div"),this.overlay.classList.add(this.options.overlay.className),this.options.overlay.style&&Object.assign(this.overlay.style,this.options.overlay.style),document.execCommand("enableObjectResizing",!1,"false"),this.quill.root.parentNode.style.position=this.quill.root.parentNode.style.position||"relative",this.quill.root.addEventListener("click",this.onClick),this.specs=this.options.specs.map((t=>new t(this))),this.specs.forEach((t=>t.init()))}show(t){this.currentSpec=t,this.currentSpec.setSelection(),this.setUserSelect("none"),this.quill.root.parentNode.appendChild(this.overlay),this.repositionOverlay(),this.createActions(t)}hide(){this.currentSpec&&(this.currentSpec.onHide(),this.currentSpec=null,this.quill.root.parentNode.removeChild(this.overlay),this.overlay.style.setProperty("display","none"),this.setUserSelect(""),this.destroyActions())}update(){this.repositionOverlay(),this.actions.forEach((t=>t.onUpdate()))}createActions(t){this.actions=t.getActions().map((t=>(t.onCreate(),t)))}destroyActions(){this.actions.forEach((t=>t.onDestroy())),this.actions=[]}repositionOverlay(){if(!this.currentSpec)return;const t=this.currentSpec.getOverlayElement();if(!t)return;const e=this.quill.root.parentNode,r=t.getBoundingClientRect(),o=e.getBoundingClientRect();Object.assign(this.overlay.style,{display:"block",left:`${r.left-o.left-1+e.scrollLeft}px`,top:`${r.top-o.top+e.scrollTop}px`,width:`${r.width}px`,height:`${r.height}px`})}setUserSelect(t){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach((e=>{this.quill.root.style.setProperty(e,t),document.documentElement&&document.documentElement.style.setProperty(e,t)}))}}},402:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(329)),i=o(r(643)),s={specs:[n.default,i.default],overlay:{className:"blot-formatter__overlay",style:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"}},align:{attribute:"data-align",icons:{left:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>\n        </svg>\n      ',center:'\n        <svg viewbox="0 0 18 18">\n           <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>\n        </svg>\n      ',right:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>\n        </svg>\n      '},toolbar:{allowDeselect:!0,mainClassName:"blot-formatter__toolbar",mainStyle:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default",zIndex:"1"},buttonClassName:"blot-formatter__toolbar-button",addButtonSelectStyle:!0,buttonStyle:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},svgStyle:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"}}},resize:{handleClassName:"blot-formatter__resize-handle",handleStyle:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"}}};e.default=s},572:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.formatter=t}onCreate(){}onDestroy(){}onUpdate(){}}},751:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(1)),i=o(r(572));class s extends i.default{constructor(){super(...arguments),this.onKeyUp=t=>{if(this.formatter.currentSpec&&("Delete"===t.code||"Backspace"===t.code)){const t=this.formatter.currentSpec.getTargetElement();if(t){const e=n.default.find(t);if(e){const t=this.formatter.quill.getIndex(e);this.formatter.quill.deleteText(t,1)}}this.formatter.hide()}}}onCreate(){document.addEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.addEventListener("input",this.onKeyUp,!0)}onDestroy(){document.removeEventListener("keyup",this.onKeyUp),this.formatter.quill.root.removeEventListener("input",this.onKeyUp)}}e.default=s},108:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(572));class i extends n.default{constructor(t){super(t),this.onMouseDown=t=>{if(!(t.target instanceof HTMLElement))return;if(this.dragHandle=t.target,this.setCursor(this.dragHandle.style.cursor),!this.formatter.currentSpec)return;const e=this.formatter.currentSpec.getTargetElement();if(!e)return;const r=e.getBoundingClientRect();this.dragStartX=t.clientX,this.preDragWidth=r.width,this.targetRatio=r.height/r.width,document.addEventListener("mousemove",this.onDrag),document.addEventListener("mouseup",this.onMouseUp)},this.onDrag=t=>{if(!this.formatter.currentSpec)return;const e=this.formatter.currentSpec.getTargetElement();if(!e)return;const r=t.clientX-this.dragStartX;let o=0;o=this.dragHandle===this.topLeftHandle||this.dragHandle===this.bottomLeftHandle?Math.round(this.preDragWidth-r):Math.round(this.preDragWidth+r);const n=this.targetRatio*o;e.setAttribute("width",`${o}`),e.setAttribute("height",`${n}`),this.formatter.update()},this.onMouseUp=()=>{this.setCursor(""),document.removeEventListener("mousemove",this.onDrag),document.removeEventListener("mouseup",this.onMouseUp)},this.topLeftHandle=this.createHandle("top-left","nwse-resize"),this.topRightHandle=this.createHandle("top-right","nesw-resize"),this.bottomRightHandle=this.createHandle("bottom-right","nwse-resize"),this.bottomLeftHandle=this.createHandle("bottom-left","nesw-resize"),this.dragHandle=null,this.dragStartX=0,this.preDragWidth=0,this.targetRatio=0}onCreate(){this.formatter.overlay.appendChild(this.topLeftHandle),this.formatter.overlay.appendChild(this.topRightHandle),this.formatter.overlay.appendChild(this.bottomRightHandle),this.formatter.overlay.appendChild(this.bottomLeftHandle);const t=this.formatter.options.resize.handleStyle||{};this.repositionHandles(t)}onDestroy(){this.setCursor(""),this.formatter.overlay.removeChild(this.topLeftHandle),this.formatter.overlay.removeChild(this.topRightHandle),this.formatter.overlay.removeChild(this.bottomRightHandle),this.formatter.overlay.removeChild(this.bottomLeftHandle)}createHandle(t,e){const r=document.createElement("div");return r.classList.add(this.formatter.options.resize.handleClassName),r.setAttribute("data-position",t),r.style.cursor=e,this.formatter.options.resize.handleStyle&&Object.assign(r.style,this.formatter.options.resize.handleStyle),r.addEventListener("mousedown",this.onMouseDown),r}repositionHandles(t){let e="0px",r="0px";t&&(t.width&&(e=-parseFloat(t.width)/2+"px"),t.height&&(r=-parseFloat(t.height)/2+"px")),Object.assign(this.topLeftHandle.style,{left:e,top:r}),Object.assign(this.topRightHandle.style,{right:e,top:r}),Object.assign(this.bottomRightHandle.style,{right:e,bottom:r}),Object.assign(this.bottomLeftHandle.style,{left:e,bottom:r})}setCursor(t){if(document.body&&(document.body.style.cursor=t),this.formatter.currentSpec){const e=this.formatter.currentSpec.getOverlayElement();e&&(e.style.cursor=t)}}}e.default=i},737:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(572)),i=o(r(185)),s=o(r(320));class l extends n.default{constructor(t){super(t),this.aligner=new i.default(t.options.align),this.toolbar=new s.default}onCreate(){const t=this.toolbar.create(this.formatter,this.aligner);this.formatter.overlay.appendChild(t)}onDestroy(){const t=this.toolbar.getElement();t&&(this.formatter.overlay.removeChild(t),this.toolbar.destroy())}}e.default=l},87:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageAlign=e.IframeAlign=e.InlineBlot=void 0;const n=o(r(1));e.InlineBlot=n.default.import("blots/inline");const i=n.default.import("parchment"),{ClassAttributor:s,Scope:l}=i,a=new s("iframeAlign","ql-iframe-align",{scope:l.BLOCK,whitelist:["left","center","right"]});e.IframeAlign=a;const c=new s("imageAlign","ql-image-align",{scope:l.INLINE,whitelist:["left","center","right"]});e.ImageAlign=c,n.default.register({"formats/imageAlign":c,"attributors/class/imageAlign":c,"formats/iframeAlign":a,"attributors/class/iframeAlign":a},!0)},185:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});const o=r(87),n="left",i="center",s="right";e.default=class{constructor(t){this.alignments={[n]:{name:n,icon:t.icons.left,apply:t=>{this.setAlignment(t,n)}},[i]:{name:i,icon:t.icons.center,apply:t=>{this.setAlignment(t,i)}},[s]:{name:s,icon:t.icons.right,apply:t=>{this.setAlignment(t,s)}}}}getAlignments(){return Object.keys(this.alignments).map((t=>this.alignments[t]))}clear(t){null!=t&&("IMG"===t.domNode.tagName?null!==t.parent&&"SPAN"===t.parent.domNode.tagName&&t.parent.format(o.ImageAlign.attrName,!1):"IFRAME"===t.domNode.tagName&&t.format(o.IframeAlign.attrName,!1))}isAligned(t,e){if(null!=t){if("IMG"===t.domNode.tagName)return null!=t.parent&&t.parent.formats()[o.ImageAlign.attrName]===e.name;if("IFRAME"===t.domNode.tagName)return t.domNode.classList.contains(`${o.IframeAlign.keyName}-${e.name}`)}return!1}setAlignment(t,e){if(null!=t){const r=this.isAligned(t,this.alignments[e]);this.clear(t),"IMG"!==t.domNode.tagName||r?"IFRAME"!==t.domNode.tagName||r||t.format(o.IframeAlign.attrName,this.alignments[e].name):t.format(o.ImageAlign.attrName,this.alignments[e].name)}}}},320:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(1));e.default=class{constructor(){this.toolbar=null,this.buttons=[]}create(t,e){const r=document.createElement("div");return r.classList.add(t.options.align.toolbar.mainClassName),this.addToolbarStyle(t,r),this.addButtons(t,r,e),this.toolbar=r,this.toolbar}destroy(){this.toolbar=null,this.buttons=[]}getElement(){return this.toolbar}addToolbarStyle(t,e){t.options.align.toolbar.mainStyle&&Object.assign(e.style,t.options.align.toolbar.mainStyle)}addButtonStyle(t,e,r){if(r.options.align.toolbar.buttonStyle&&(Object.assign(t.style,r.options.align.toolbar.buttonStyle),e>0&&(t.style.borderLeftWidth="0")),r.options.align.toolbar.svgStyle){const e=t.children[0];e&&Object.assign(e.style,r.options.align.toolbar.svgStyle)}}addButtons(t,e,r){r.getAlignments().forEach(((o,n)=>{const i=document.createElement("span");i.classList.add(t.options.align.toolbar.buttonClassName),i.innerHTML=o.icon,i.addEventListener("click",(()=>{this.onButtonClick(i,t,o,r)})),this.preselectButton(i,o,t,r),this.addButtonStyle(i,n,t),this.buttons.push(i),e.appendChild(i)}))}preselectButton(t,e,r,o){if(!r.currentSpec)return;const i=r.currentSpec.getTargetElement();if(!i)return;const s=n.default.find(i);o.isAligned(s,e)&&this.selectButton(r,t)}onButtonClick(t,e,r,o){if(!e.currentSpec)return;const n=e.currentSpec.getTargetElement();n&&this.clickButton(t,n,e,r,o)}clickButton(t,e,r,o,i){this.buttons.forEach((t=>{this.deselectButton(r,t)}));const s=n.default.find(e);i.isAligned(s,o)?r.options.align.toolbar.allowDeselect?i.clear(s):this.selectButton(r,t):(this.selectButton(r,t),o.apply(s)),r.update()}selectButton(t,e){e.classList.add("is-selected"),t.options.align.toolbar.addButtonSelectStyle&&e.style.setProperty("filter","invert(20%)")}deselectButton(t,e){e.classList.remove("is-selected"),t.options.align.toolbar.addButtonSelectStyle&&e.style.removeProperty("filter")}}},156:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.IframeVideoSpec=e.UnclickableBlotSpec=e.ImageSpec=e.BlotSpec=e.ResizeAction=e.DeleteAction=e.DefaultToolbar=e.DefaultAligner=e.AlignAction=e.Action=e.default=e.DefaultOptions=void 0;var n=r(402);Object.defineProperty(e,"DefaultOptions",{enumerable:!0,get:function(){return o(n).default}});var i=r(797);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o(i).default}});var s=r(572);Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return o(s).default}});var l=r(737);Object.defineProperty(e,"AlignAction",{enumerable:!0,get:function(){return o(l).default}});var a=r(185);Object.defineProperty(e,"DefaultAligner",{enumerable:!0,get:function(){return o(a).default}});var c=r(320);Object.defineProperty(e,"DefaultToolbar",{enumerable:!0,get:function(){return o(c).default}});var u=r(751);Object.defineProperty(e,"DeleteAction",{enumerable:!0,get:function(){return o(u).default}});var d=r(108);Object.defineProperty(e,"ResizeAction",{enumerable:!0,get:function(){return o(d).default}});var h=r(601);Object.defineProperty(e,"BlotSpec",{enumerable:!0,get:function(){return o(h).default}});var f=r(329);Object.defineProperty(e,"ImageSpec",{enumerable:!0,get:function(){return o(f).default}});var m=r(260);Object.defineProperty(e,"UnclickableBlotSpec",{enumerable:!0,get:function(){return o(m).default}});var p=r(643);Object.defineProperty(e,"IframeVideoSpec",{enumerable:!0,get:function(){return o(p).default}})},601:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(737)),i=o(r(108)),s=o(r(751));e.default=class{constructor(t){this.formatter=t}init(){}getActions(){return[new n.default(this.formatter),new i.default(this.formatter),new s.default(this.formatter)]}getTargetElement(){return null}getOverlayElement(){return this.getTargetElement()}setSelection(){this.formatter.quill.setSelection(null)}onHide(){}}},643:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(260));class i extends n.default{constructor(t){super(t,"iframe.ql-video")}}e.default=i},329:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(601));class i extends n.default{constructor(t){super(t),this.onClick=t=>{const e=t.target;e instanceof HTMLElement&&"IMG"===e.tagName&&(this.img=e,this.formatter.show(this))},this.img=null}init(){this.formatter.quill.root.addEventListener("click",this.onClick)}getTargetElement(){return this.img}onHide(){this.img=null}}e.default=i},260:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=o(r(601)),i="data-blot-formatter-unclickable-bound";class s extends n.default{constructor(t,e){super(t),this.onTextChange=()=>{Array.from(document.querySelectorAll(this.selector)).filter((t=>!t.hasAttribute(i))).forEach((t=>{t.setAttribute(i,"true"),t.addEventListener("mouseenter",this.onMouseEnter)}))},this.onMouseEnter=t=>{const e=t.target;e instanceof HTMLElement&&(this.nextUnclickable=e,this.repositionProxyImage(this.nextUnclickable))},this.onProxyImageClick=()=>{this.unclickable=this.nextUnclickable,this.nextUnclickable=null,this.formatter.show(this),this.hideProxyImage()},this.selector=e,this.unclickable=null,this.nextUnclickable=null}init(){document.body&&document.body.appendChild(this.createProxyImage()),this.hideProxyImage(),this.proxyImage.addEventListener("click",this.onProxyImageClick),this.formatter.quill.on("text-change",this.onTextChange)}getTargetElement(){return this.unclickable}getOverlayElement(){return this.unclickable}onHide(){this.hideProxyImage(),this.nextUnclickable=null,this.unclickable=null}createProxyImage(){const t=document.createElement("canvas"),e=t.getContext("2d");return e&&(e.globalAlpha=0,e.fillRect(0,0,1,1)),this.proxyImage=document.createElement("img"),this.proxyImage.src=t.toDataURL("image/png"),this.proxyImage.classList.add("blot-formatter__proxy-image"),Object.assign(this.proxyImage.style,{position:"absolute",margin:"0"}),this.proxyImage}hideProxyImage(){Object.assign(this.proxyImage.style,{display:"none"})}repositionProxyImage(t){const e=t.getBoundingClientRect();Object.assign(this.proxyImage.style,{display:"block",left:`${e.left+window.pageXOffset}px`,top:`${e.top+window.pageYOffset}px`,width:`${e.width}px`,height:`${e.height}px`})}}e.default=s},1:e=>{e.exports=t}},r={};function o(t){var n=r[t];if(void 0!==n)return n.exports;var i=r[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}return o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o(156)})()));