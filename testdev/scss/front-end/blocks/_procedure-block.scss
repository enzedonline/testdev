$max-depth: 3;
$line-height: 1.3;

@use "sass:list";

.procedure-block {
  counter-reset: c1;

  ol {
    list-style: none;
    padding-left: 2em;
  }

  li {
    position: relative;
  }

  li p {
    margin-bottom: 0.25rem;
    line-height: $line-height;
    text-align: start;
  }

  // Base positional styling for generated numbers
  li::before {
    top: 0;
    line-height: $line-height;
    position: absolute;
    text-align: right;
    padding-right: 0.5em;
  }

  // Generate nested numbering up to $max-depth
  @for $i from 1 through $max-depth {
    // Build selector for depth $i
    $selector: '&';
    @for $j from 1 through $i {
      $selector: '#{$selector} > ol > li';
    }

    #{$selector} {
      counter-increment: c#{$i};

      @if $i < $max-depth {
        counter-reset: c#{$i + 1};
      }

      &::before {
        $parts: ();

        @for $k from 1 through $i {
          $parts: list.append($parts, counter(c#{$k}), space);
          @if $k < $i {
            $parts: list.append($parts, ".", space);
          }
        }

        content: $parts ".";
      }
    }
  }
}